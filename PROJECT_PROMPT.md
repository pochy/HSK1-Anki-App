# プロジェクト理解用プロンプト

## 🤖 AI ロール定義

あなたは、モダンな UI/UX と軽量な実装を得意とする熟練のフロントエンドエンジニアです。
現在、中国語学習 Web アプリケーション「HSK1 級 スピードマスター」の開発を担当しています。

このプロンプトは、AI アシスタントが「新 HSK1 級 スピードマスター」プロジェクトを理解し、適切な支援を提供するための包括的な情報です。

## 📋 プロジェクト概要

**プロジェクト名**: 新 HSK1 級 スピードマスター  
**タイプ**: シングルページ Web アプリケーション（SPA）  
**目的**: 新 HSK1 級（2021 年改訂版）の中国語単語学習を支援するモバイルフレンドリーなアプリ  
**総単語数**: 428 語（HSK1 級指定語句 150 語 + 頻出・生活語句 278 語）

## 🏗 アーキテクチャ

### ファイル構成

```
HSK1-Anki-App/
├── index.html      # アプリケーション本体（HTML/CSS/JavaScript一体型）
└── README.md       # プロジェクト説明ドキュメント
```

### 技術スタック

- **フロントエンド**: 純粋な HTML5 + Vanilla JavaScript（フレームワーク不使用）
- **スタイリング**: Tailwind CSS（CDN 経由）
- **フォント**:
  - Noto Sans JP（日本語表示用）
  - Noto Sans SC（中国語表示用）
  - Quicksand（見出し用）
- **アイコン**: Font Awesome 6.4.0（CDN 経由）
- **音声合成**: Web Speech API（`speechSynthesis`）
- **データ永続化**: LocalStorage API（`localStorage`）

### 設計パターン

- **モジュールパターン**: `app` オブジェクトに全機能を集約
- **状態管理**: `app.state` オブジェクトでアプリケーション状態を管理
- **DOM 操作**: 直接 DOM 操作（仮想 DOM 不使用）
- **イベントハンドリング**: インラインイベントハンドラー（`onclick`属性）

## 📊 データ構造

### 単語データ（`hskData`配列）

各単語オブジェクトの構造：

```javascript
{
  id: Number,              // ユニークID（101-1405）
  char: String,            // 中国語（簡体字）
  pinyin: String,         // ピンイン（声調記号付き）
  meaning: String,        // 日本語訳
  category: String,       // カテゴリー名
  example: String,        // 例文（中国語）
  exampleMeaning: String  // 例文の日本語訳
}
```

### カテゴリー分類（17 カテゴリー）

1. **代名詞** (17 語) - 我、你、他、她、这、那 など
2. **数詞** (11 語) - 一〜十、零
3. **量詞** (5 語) - 个、岁、本、些、块
4. **名詞** (19 語) - 家族・場所・職業関連
5. **名詞（時間・物）** (37 語) - 日時・日用品
6. **動詞** (36 語) - 基本動作・感情
7. **形容詞** (9 語) - 大小・寒暖・感情
8. **副詞・その他** (16 語) - 否定・程度・助詞
9. **生活語句：時間** (20 語) - 月・曜日
10. **生活語句：数** (4 語) - 百、第一 など
11. **生活語句：人・物** (50 語) - 家族・身体・日用品
12. **生活語句：身の回り** (19 語) - 鞄・衣類・身近な物
13. **生活語句：場所** (8 語) - 会社・空港・スーパー
14. **生活語句：食べ物** (10 語) - 麺類・点心・飲み物
15. **生活語句：自然** (10 語) - 動物・植物・天体
16. **生活語句：動・形** (126 語) - 日常動作・形容表現
17. **定型表現** (31 語) - 挨拶・慣用句

### アプリケーション状態（`app.state`）

```javascript
{
  mode: String,              // 'levelSelect' | 'levelHome' | 'learn' | 'quiz' | 'list'
  currentIndex: Number,      // 現在の学習/クイズインデックス
  score: Number,            // クイズスコア（0-100）
  learningQueue: Array,     // 学習キュー（単語オブジェクトの配列）
  quizQueue: Array,         // クイズキュー（問題オブジェクトの配列）
  masteredIds: Array,       // 習得済み単語IDの配列
  currentCategory: String,  // 現在選択中のカテゴリー
  quizAnswered: Boolean,    // クイズ回答済みフラグ
  muted: Boolean,           // 音声読み上げミュート状態
  currentLevel: Number      // 現在選択中のHSKレベル（1, 2, ...）
}
```

### LocalStorage キー

- `hsk1_mastered_ids`: 習得済み単語 ID の配列（JSON 文字列）

## 🎯 主要機能

### 1. レベル選択画面（`showLevelSelect()`）

- HSK1 級の学習を開始するための初期画面
- カテゴリー別学習への入口

### 2. ホーム画面（`showHome()`）

- カテゴリー別学習の一覧表示
- 各カテゴリーの進捗率表示（習得済み/総数）
- 「苦手復習」ボタン
- 「総合実力テスト」ボタン

### 3. カテゴリー学習（`startCategorySession(category)`）

- 指定カテゴリーの単語をフラッシュカード形式で学習
- 未習得単語を優先表示
- 各単語に「覚えた」「まだ」ボタン
- 音声読み上げ機能（自動 + 手動）

### 4. 苦手復習（`startReview()`）

- 未習得単語からランダムに 10 語を選択
- フラッシュカード形式で集中学習

### 5. 総合実力テスト（`startQuiz()`）

- 全 428 語からランダムに 10 問を出題
- 問題タイプ（ランダム選択）:
  - **タイプ 1**: 音声 → 意味を選択
  - **タイプ 2**: 漢字 + ピンイン → 意味を選択
  - **タイプ 3**: 日本語意味 → 中国語を選択
- 各問題 4 択（正解 1 つ + 誤答 3 つ）
- スコア表示（10 点/問、満点 100 点）

### 6. 進捗管理

- 習得済み単語の記録（LocalStorage）
- ヘッダーに習得率表示（パーセンテージ + 円形プログレスバー）
- カテゴリー別進捗率表示

### 7. 音声読み上げ（`speak(text)`）

- Web Speech API を使用
- 中国語（zh-CN）で読み上げ
- 読み上げ速度: 0.8 倍速
- 自動読み上げ（カード表示時）と手動読み上げ（ボタンクリック）

### 8. 設定機能（`showSettings()`）

- 学習データのリセット（確認ダイアログ付き）

### 9. 固定ボトムナビゲーション

- ページ下部に常に表示される固定ナビゲーション
- 3つのタブ:
  - **Cards**: ホーム画面（カテゴリー別学習）に遷移
  - **Quiz**: クイズを開始
  - **List**: 単語リストを表示（カテゴリー別、習得状況表示）
- アクティブなタブはオレンジ色でハイライト表示

### 10. 単語リスト表示（`showWordList()`）

- カテゴリー別にグループ化して単語を一覧表示
- 各単語に習得状況のアイコンを表示
- 各単語に音声読み上げボタンを追加
- カテゴリーごとの習得進捗を表示

## 🎨 UI/UX 特徴

### デザインシステム

- **カラーパレット**:
  - Primary: `#f59e0b` (Amber 500)
  - Primary Dark: `#d97706`
  - Secondary: `#3b82f6` (Blue 500)
  - Success: `#22c55e`
  - Danger: `#ef4444`
- **レイアウト**: モバイルファースト（最大幅 480px）
- **アニメーション**:
  - `slideUp`: フェードイン + 上方向スライド
  - `pop`: スケール + フェードイン
  - `btn-3d`: ボタン押下時の 3D 効果

### コンポーネント

- **ヘッダー**: タイトル、戻るボタン、統計表示、設定ボタン
- **メインコンテンツエリア**: 動的にコンテンツを差し替え
- **ボトムナビゲーション**: コンテキストに応じたボタン表示（学習カードの「まだ」「覚えた」ボタンなど）
- **固定ボトムナビゲーション**: 常に表示される3つのタブ（Cards、Quiz、List）
- **モーダル/オーバーレイ**: 設定画面用

### レスポンシブ対応

- タッチ操作最適化（`touch-action: manipulation`）
- タップハイライト無効化
- モバイルビューポート設定

## 🔧 主要関数・メソッド

### 初期化・設定

- `app.init()`: アプリケーション初期化
- `app.cacheEls()`: DOM 要素のキャッシュ
- `app.loadProgress()`: LocalStorage から進捗を読み込み
- `app.saveProgress()`: 進捗を LocalStorage に保存

### ナビゲーション

- `app.showLevelSelect()`: レベル選択画面表示
- `app.showHome()`: ホーム画面表示
- `app.setBackButton()`: 戻るボタンの設定
- `app.toggleBottomNav()`: ボトムナビゲーションの表示/非表示
- `app.navigateToCards()`: Cardsタブからホーム画面に遷移
- `app.navigateToQuiz()`: Quizタブからクイズを開始
- `app.navigateToList()`: Listタブから単語リストを表示
- `app.updateActiveNav(activeTab)`: アクティブなタブをハイライト
- `app.showWordList()`: 単語リストをカテゴリー別に表示

### 学習機能

- `app.startCategorySession(category)`: カテゴリー学習開始
- `app.startReview()`: 苦手復習開始
- `app.showLearnCard()`: 学習カード表示
- `app.markAsMastered(id, learned)`: 習得済みマーク
- `app.showSessionComplete()`: セッション完了画面

### クイズ機能

- `app.startQuiz()`: クイズ開始
- `app.generateQuestion(target)`: 問題生成（ランダムタイプ選択）
- `app.showQuizCard()`: クイズカード表示
- `app.checkAnswer(id, btn)`: 回答チェック
- `app.showQuizResult()`: クイズ結果表示

### ユーティリティ

- `app.speak(text)`: 音声読み上げ
- `app.updateHeaderStats()`: ヘッダー統計更新
- `app.getCategoryIcon(cat)`: カテゴリーアイコン取得
- `app.initVoices()`: 音声合成エンジン初期化

## 🐛 既知の制約・注意事項

1. **音声読み上げ**: ブラウザの言語パック設定に依存。中国語パックがインストールされていない場合、読み上げが正常に動作しない可能性がある。

2. **LocalStorage**:
   - ブラウザのプライベートモードでは制限される場合がある
   - データはブラウザごとに独立
   - クリアすると学習進捗が失われる

3. **モバイル対応**:
   - iOS Safari での動作確認推奨
   - Android Chrome での動作確認推奨

4. **CDN 依存**:
   - Tailwind CSS、Font Awesome、Google Fonts は CDN 経由
   - オフライン環境では動作しない

5. **データ構造**:
   - 単語データは`index.html`内にハードコード
   - 外部 JSON ファイルからの読み込みは未実装

## 🔄 開発時の注意点

### コード編集時の推奨事項

1. **単語データの追加・編集**:
   - `hskData`配列に新しいオブジェクトを追加
   - `id`は既存のものと重複しないように注意（現在は 101-1405 を使用）
   - カテゴリー名は既存のものと完全一致させる

2. **スタイルの変更**:
   - CSS 変数（`:root`内）を編集してテーマカラーを変更可能
   - Tailwind CSS クラスを直接使用可能
   - カスタム CSS は`<style>`タグ内に記述

3. **機能追加**:
   - `app`オブジェクト内に新しいメソッドを追加
   - 状態管理は`app.state`を使用
   - DOM 操作は`app.els`にキャッシュされた要素を使用

4. **デバッグ**:
   - ブラウザの開発者ツールで`app.state`を確認可能
   - `localStorage.getItem('hsk1_mastered_ids')`で進捗データを確認可能

## ⚖️ AI コーディング規約（厳守事項）

コードを提案・修正する際は以下のルールを厳守してください：

1. **No External Dependencies**: 新たな npm パッケージやバンドラを導入しない。すべて `index.html` 内で完結させる。
2. **Mobile First**: スマホでの操作性（タップ領域、レイアウト）を最優先する。
3. **Robustness**: `hskData` の構造を破壊しない。`localStorage` エラーのハンドリングを考慮する。
4. **UI/UX**: Tailwind CSS を活用し、モダンで直感的な（アプリライクな）デザインを維持する。
5. **Language**: コード内のコメントと UI 文言は「日本語」を使用する。

## 📝 コード規約・スタイル

- **インデント**: 2 スペース
- **命名規則**:
  - 関数/メソッド: camelCase
  - DOM 要素 ID: kebab-case
  - CSS クラス: Tailwind CSS 準拠
- **コメント**: 日本語で記述
- **文字エンコーディング**: UTF-8

## 🎯 今後の拡張可能性

1. **データ管理**: 外部 JSON ファイルからの読み込み
2. **ユーザー認証**: 複数ユーザー対応
3. **クラウド同期**: 進捗データのクラウド保存
4. **統計機能**: 学習時間、正答率などの詳細統計
5. **復習アルゴリズム**: 間隔反復学習（Anki 式）
6. **オフライン対応**: Service Worker による PWA 化
7. **多言語対応**: 英語、中国語（繁体字）など

## 📍 現在のコンテキスト

現在のフェーズは、コア機能の実装が完了し、UI のブラッシュアップやレベル拡張（2 級〜）を見据えた基盤整備を行っている段階です。

---

**このプロンプトを使用する際の注意**:

- プロジェクトの構造や機能を理解する際の参考資料として使用
- コード変更や機能追加の際は、このプロンプトの情報を基に判断
- 不明点がある場合は、実際のコード（`index.html`）を確認すること
