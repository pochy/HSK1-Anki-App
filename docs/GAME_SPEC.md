# Anki忘却曲線活用ゲーム開発仕様書：詳細設計版

## 1. 概要と目的

本ドキュメントは、ヘルマン・エビングハウスの「忘却曲線」理論と、Anki等の学習アプリで採用されている「間隔反復システム（SRS: Spaced Repetition System）」を、ゲームメカニクスとして昇華させた4つの学習アプリケーションの詳細仕様を定義するものです。

**プロジェクトの目的:** 単調になりがちな「復習」という作業に、RPGやシミュレーションの文脈（コンテキスト）を与えることで、ユーザーの能動的な学習意欲を引き出し、長期的な記憶定着率（Retention Rate）を向上させることを目的とします。

---

## 2. 構文構築ゲーム：言葉の鍛冶屋 (Sentence Smith)

- **ジャンル:** パズル / タイムアタック / クラフト
- **学習対象:** 語学（英文法、慣用句）、プログラミングコード（構文、アルゴリズム）
- **ターゲット層:** 瞬発的な構成力を養いたい語学学習者、コーディング初心者

### 2.1 コアコンセプト詳細

プレイヤーは「言葉の鍛冶職人」です。バラバラに砕けた素材（単語やコード片）を、炉の火が消える前に正しい順序で叩き（配置し）、強靭な武器や防具を鍛え上げます。 正解までの「スピード」と「正確性」が、鍛え上がるアイテムの品質（レアリティ）と、次回の復習タイミング（冷却期間）を決定します。

### 2.2 データ構造 (Extended Data Structure)

```json
{
  "card_id": 101,
  "original_sentence": "She plays the piano every day.",
  "tokens": [
    { "id": "t1", "text": "She", "type": "subject" },
    { "id": "t2", "text": "plays", "type": "verb" },
    { "id": "t3", "text": "the", "type": "article" },
    { "id": "t4", "text": "piano", "type": "object" },
    { "id": "t5", "text": "every", "type": "adjective" },
    { "id": "t6", "text": "day", "type": "noun" },
    { "id": "t7", "text": ".", "type": "punctuation" }
  ],
  "distractors": ["he", "playing", "yesterday"], // 難易度調整用のダミー単語
  "difficulty_level": 1, // 1:短文(3-5単語), 5:長文(15単語以上)
  "srs_data": {
    "next_review": "2025-10-20",
    "interval": 1, // 現在の間隔（日）
    "ease_factor": 2.5, // 難易度係数
    "streak": 0
  },
  "item_metadata": {
    "type": "sword",
    "rarity": "common" // 過去の正解率に基づく
  }
}
```

### 2.3 ゲームロジックとフロー (Game Logic)

1.  **素材の準備（Pre-Game）:**
    - 対象の文章をトークン化し、配列をシャッフルします。
    - **Distractor Logic:** 難易度が高い場合、類似した品詞のダミー単語（例: "plays" に対する "playing"）をインベントリに混ぜ込み、選択肢を増やします。
2.  **鍛錬フェーズ (Interaction):**
    - **UI:** 画面下部に「素材置き場」、中央に「金床（スロット）」を表示。
    - **Action:** プレイヤーは素材をドラッグ＆ドロップで金床に配置。
    - **Feedback:** 正しい位置に置かれた瞬間に微かな火花のエフェクト（ヒント機能としてON/OFF可）。
    - **Submit:** 配置完了後、「打つ（Forge）」ボタンで確定。
3.  **SRS判定アルゴリズム:**
    - **Legendary (Easy):** 3秒以内かつミスなしで完成。 -> `interval * 2.5`, `ease_factor + 0.15`。アイテムは「伝説級」の輝きを放つ。
    - **Epic (Good):** 制限時間内かつミスなし。 -> `interval * 1.8`。アイテムは「良業物」。
    - **Rare (Hard):** 1回ミスして修正、または時間がかかった。 -> `interval * 1.2`, `ease_factor - 0.15`。アイテムは「数打ち」。
    - **Broken (Again):** ギブアップ、または3回以上ミス。 -> `interval = 1`, `ease_factor - 0.2`。アイテムは砕け散り、再挑戦となる。

### 2.4 UI/UX・演出要件

- **視覚効果:**
  - 正解時：ハンマーが振り下ろされ、激しい火花とともに完成した文章が光り輝く。
  - 連鎖ボーナス：連続正解（ストリーク）中は、炉の火が青白く高温になり、BGMのテンポが上がる。
- **聴覚効果:**
  - 配置音：金属的な「カキン」「チン」という音。
  - TTS連携：完成時、ネイティブ発音で文章が読み上げられる。

---

## 3. 育成シミュレーション：記憶の庭 (Garden of Memory)

- **ジャンル:** 放置系育成ゲーム / ガーデニング
- **学習対象:** 英単語、歴史年号、法律用語、定義などの暗記項目
- **ターゲット層:** コツコツと積み上げることに喜びを感じる学習者、癒やしを求める層

### 3.1 コアコンセプト詳細

ユーザーの脳内にある知識の集合体を「庭園」として可視化します。各知識は一本の「植物」です。 学習直後の植物は水分をたっぷり含んでいますが、忘却曲線に従って時間とともに水分が蒸発（Decay）し、最終的に枯れてしまいます。 プレイヤーの役割は、枯れる直前の「最適なタイミング」で水（復習）を与え、植物をより強壮な形態へと進化させることです。

### 3.2 データ構造 (Extended Data Structure)

```json
{
  "plant_id": "vocab_apple",
  "content": {
    "question": "りんご",
    "answer": "apple"
  },
  "visual_state": {
    "type": "AppleTree",
    "stage": 2, // 0:Seed, 1:Sprout, 2:Sapling, 3:Mature Tree, 4:Ancient Guardian
    "color_code": "#4ADE80"
  },
  "status": {
    "hydration": 80.5, // 0.0 - 100.0%
    "withered": false // 枯死フラグ
  },
  "srs_parameters": {
    "last_watered": 1699999999, // Unix Timestamp
    "decay_rate": 5.0, // 1時間あたりの水分減少量。進化するほど低くなる。
    "stability": 10 // 記憶の安定性
  }
}
```

### 3.3 ゲームロジックとフロー (Game Logic)

1.  **枯渇シミュレーション (Real-time Decay):**
    - 計算式: `current_hydration = 100 - ((現在時刻 - last_watered) * decay_rate)`
    - **忘却曲線の適用:** 初期段階（Seed）は `decay_rate` が非常に高く（数時間で乾く）、進化（Tree）すると極端に低くなる（数ヶ月持つ）。
2.  **水やりイベント (Review Session):**
    - クイズ正解で水分が100%にリセット。
    - **危機回避ボーナス (Crisis Bonus):** 水分が20%以下（忘却の瀬戸際）で正解すると、植物は「逆境を乗り越えた」として経験値を2倍獲得し、次の形態への進化が早まる。
    - **過剰な水やり:** 水分が90%以上ある状態で無理やり復習しても、経験値はほとんど得られない（効率的な学習の推奨）。
3.  **進化システム (Evolution):**
    - 復習回数が一定を超え、かつ安定性が増すと植物が進化。
    - Seed (種) -> Sprout (芽) -> Sapling (若木) -> Tree (成木) -> Ancient (古木/精霊)。
    - Ancientになると、周囲の未熟な植物の成長を促進するバフ効果を持つ（関連語の記憶定着支援）。

### 3.4 UI/UX・演出要件

- **庭の全景ビュー:**
  - グリッドまたはアイソメトリックビューで全単語を表示。
  - **カラーコーディング:** 水分量に応じて、鮮やかな緑 -> 黄色 -> 茶色 -> 灰色（枯死）へとリアルタイムに色が変化。
- **通知システム:**
  - 「水分不足のアラート」をプッシュ通知。
  - 庭の中で「！」マークが点滅し、助けを求めている演出。

---

## 4. ローグライクRPG：忘却のダンジョン (Rogue-like Memory)

- **ジャンル:** ダンジョン探索RPG / ハックアンドスラッシュ
- **学習対象:** 一問一答形式の知識全般、資格試験の過去問
- **ターゲット層:** ゲーム性を強く求める層、リスク＆リワードを楽しみたい層

### 4.1 コアコンセプト詳細

プレイヤーは「忘却のダンジョン」に挑む冒険者です。最大の特徴は、装備している武器・防具・魔法が「学習カード」そのものである点です。 時間が経過するにつれ、装備は「錆び（忘却）」ていき、攻撃力や防御力が低下します。ダンジョン内での戦闘（クイズ）こそが、装備を研ぎ澄ます唯一の手段です。

### 4.2 データ構造 (Extended Data Structure)

```json
{
  "item_id": "sword_math_formula_01",
  "name": "二次方程式の解の公式",
  "base_stats": {
    "attack": 50,
    "defense": 0,
    "attribute": "logic" // 属性（科目）
  },
  "condition": {
    "sharpness": 0.4, // 0.0 - 1.0 (忘却曲線係数)
    "status_label": "Rusty" // Sharp, Dull, Rusty, Broken
  },
  "dynamic_stats": {
    "current_attack": 20 // base_attack * sharpness
  }
}
```

### 4.3 ゲームロジックとフロー (Game Logic)

1.  **戦闘システム (Combat Review):**
    - 敵エンカウント時、攻撃または防御アクションを選択すると、装備中のカードから問題が出題される。
    - **正解（Easy/Good）:**
      - `sharpness` が 1.0 に回復（砥石効果）。
      - 敵に `base_attack` 分のダメージを与える。
    - **不正解（Again）:**
      - 攻撃ミス（Miss）。
      - プレイヤーは敵からダメージを受け、装備の耐久度が下がる。
2.  **クリティカル（想起）ボーナス:**
    - **Risk & Reward:** `sharpness` が 0.3〜0.4（忘れかけ）の「錆びついた」状態で正解すると、「Recall Critical（起死回生の想起）」が発生。
    - 通常ダメージの2.5倍を与え、HPが少量回復する。
    - プレイヤーは「安全なうちに復習するか」「ギリギリまで溜めてクリティカルを狙うか」の戦略的判断を迫られる。
3.  **ダンジョン進行:**
    - 階層が深くなるほど敵が強力になる。
    - 新しい知識（カード）は「宝箱」から入手し、デッキ（装備枠）に組み込む。

### 4.4 UI/UX・演出要件

- **装備画面のメタファー:**
  - 新品（覚えたて）はピカピカに光っている。
  - 時間が経つと、ドット絵の剣に茶色の錆エフェクトが重なり、刃こぼれしていく。
- **戦闘エフェクト:**
  - 復習成功時、剣の錆がパリーンと弾け飛び、眩しい光とともに敵を切り裂く爽快な演出。

---

## 5. 文明維持シミュレーション (Civ-Style Maintenance)

- **ジャンル:** 街づくり / 経営シミュレーション / ストラテジー
- **学習対象:** カテゴリ分け（階層構造）できる知識（法律、医学、IT用語、歴史）
- **ターゲット層:** 体系的な知識を身に着けたい層、マクロな視点で学習管理したい層

### 5.1 コアコンセプト詳細

知識のカテゴリ（例：英単語、文法、リスニング）ごとに、「図書館」「病院」「発電所」「農場」などの施設を建設し、文明を発展させます。 個々の知識カードは、その施設を稼働させる「構成員」や「部品」です。復習を怠ると、その知識カードは機能を停止し、関連する施設の稼働率が下がり、街全体が荒廃（スラム化）していきます。

### 5.2 データ構造 (Extended Data Structure)

```json
{
  "building_id": "b_library_english",
  "type": "Library",
  "category_tag": "english_vocab",
  "metrics": {
    "maintenance_level": 0.85, // 所属カードの平均定着率
    "population": 150, // 所属カード数
    "output_per_tick": 100 // maintenance_levelに依存する生産リソース
  },
  "cards": [
    { "id": 1, "status": "active", "next_review": "2025-10-20" },
    {
      "id": 2,
      "status": "decaying",
      "next_review": "2025-10-01",
      "warning": true
    }
  ]
}
```
